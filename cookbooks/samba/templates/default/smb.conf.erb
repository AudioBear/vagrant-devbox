# This is the main Samba configuration file.
#
# It was dynamically generated by Chef on <%= node["fqdn"] %>
#
# Local modifications will be overwritten by Chef.
#

<% 
def setting name
  value = node.samba[name]
  smb_name = name.to_s.gsub('_', ' ')
  "#{smb_name} = #{value}" unless value.empty?
end
-%>

[global]
<% %w{ workgroup
       server_string
       security
       username_map
       interfaces
       hosts_allow
       load_printers
       passdb_backend
     }.each do |key| %>  <%= setting key %>
<% end %>

#============================ Share Definitions ==============================
<% @shares.each do |share,option| -%>
[<%= share %>]
  <% option.each do |o,v| -%>
  <%= o %> = <%= v.respond_to?(:join) ? v.join(',') : v %>
  <% end -%>

<% end -%>
